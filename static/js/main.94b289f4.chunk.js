(this["webpackJsonp2gis-test"]=this["webpackJsonp2gis-test"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(6),s=a.n(r),i=a(7),c=a(1),l=a(2),u=a(4),m=a(3),d=(a(13),a(14),function(e){var t=e.currentTab,a=e.changeTab,o=e.toRead,r=e.inProgress,s=e.done,i="navbar__item"+("toread"===t?" navbar__item_active":""),c="navbar__item"+("inprogress"===t?" navbar__item_active":""),l="navbar__item"+("done"===t?" navbar__item_active":"");return n.a.createElement("nav",{className:"navbar"},n.a.createElement("div",{className:i,onClick:function(){return a("toread")}},"To read ",n.a.createElement("span",{className:"navbar__count"},"(",o,")")),n.a.createElement("div",{className:c,onClick:function(){return a("inprogress")}},"In progress ",n.a.createElement("span",{className:"navbar__count"},"(",r,")")),n.a.createElement("div",{className:l,onClick:function(){return a("done")}},"Done ",n.a.createElement("span",{className:"navbar__count"},"(",s,")")))}),g=function(e){var t=e.tags,a=e.removeTag,o=e.clearTags;if(!t.size)return null;var r=Array.from(t).map((function(e){return n.a.createElement("span",{className:"filter__tag",onClick:function(){return a(e)},key:e},"#",e)}));return n.a.createElement("div",{className:"filter"},n.a.createElement("span",null,"Filtered by tags: "),r,"(",n.a.createElement("button",{className:"filter__clear",onClick:o},"clear"),")")},b=function(e){var t=e.tab,a=e.book,o=e.moveBook,r=e.addTag;return n.a.createElement("div",{className:"book",key:a.id},n.a.createElement("h3",{className:"book__author"},a.author),n.a.createElement("div",{className:"book__title-and-button"},n.a.createElement("h2",{className:"book__title"},a.title),function(e,t){if("toread"===e)return n.a.createElement("button",{className:"book__move-button",onClick:t},n.a.createElement("span",{className:"book__move-button-text"},"start reading")," \u2192");if("inprogress"===e)return n.a.createElement("button",{className:"book__move-button",onClick:t},n.a.createElement("span",{className:"book__move-button-text"},"finish reading")," \u2192");return n.a.createElement("button",{className:"book__move-button",onClick:t},n.a.createElement("span",{className:"book__move-button-text"},'return in "to read"')," \u21b5")}(t,(function(){return o(a.index)}))),n.a.createElement("p",{className:"book__description"},a.description),a.tags.map((function(e,t){return n.a.createElement("span",{className:"book__tag",key:t,onClick:function(){return r(e)}},"#",e)})))};var f=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).booksRef=n.a.createRef(),e.filteredBooksCount=0,e.state={countToDisplay:50},e.filterBooks=function(){var t=e.props,a=t.tab,o=t.books,n=t.tags,r=t.booksInProgressIds,s=t.booksDoneIds;return o.filter((function(e,t){return("toread"===a&&!e.moved||"inprogress"===a&&r.has(t)||"done"===a&&s.has(t))&&(!n.size||Array.from(n).every((function(t){return e.tags.includes(t)})))}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.onscroll=function(){var t=e.booksRef.current;t&&(t.getBoundingClientRect().bottom-window.innerHeight<200&&e.filteredBooksCount>e.state.countToDisplay&&e.setState({countToDisplay:e.state.countToDisplay+50}))}}},{key:"componentWillUnmount",value:function(){window.onscroll=null}},{key:"render",value:function(){var e=this.props,t=e.tab,a=e.addTag,o=e.moveBook,r=e.books,s=this.filterBooks();this.filteredBooksCount=s.length;var i=s.slice(0,this.state.countToDisplay).map((function(e){return n.a.createElement(b,{tab:t,book:e,moveBook:o,addTag:a,key:e.id})}));return i.length?n.a.createElement("div",{ref:this.booksRef},i):n.a.createElement("div",{className:"books-placeholder"},r.length?"List is empty":"Loading...")}}]),a}(n.a.Component),v=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={allBooks:[],booksInProgressIds:new Set,booksDoneIds:new Set,currentTab:"toread",tags:new Set},e.changeTab=function(t){e.setState({currentTab:t});var a=new URL(window.location.href);a.searchParams.set("tab",t),window.history.pushState("","",a.toString())},e.addTag=function(t){var a=e.state.tags;a.add(t),e.setState({tags:a});var o=new URL(window.location.href);o.searchParams.set("tags",Array.from(a).join(",")),window.history.pushState("","",o.toString())},e.removeTag=function(t){var a=e.state.tags;a.delete(t),e.setState({tags:a});var o=new URL(window.location.href);o.searchParams.set("tags",Array.from(a).join(",")),window.history.pushState("","",o.toString())},e.clearTags=function(){e.setState({tags:new Set});var t=new URL(window.location.href);t.searchParams.delete("tags"),window.history.pushState("","",t.toString())},e.startBook=function(t){var a=e.state.allBooks;a[t].moved=!0;var o=a.filter((function(e){return e.moved})).map((function(e){return e.id}));localStorage.setItem("movedBooks",JSON.stringify(o));var n=e.state.booksInProgressIds;n.add(t),localStorage.setItem("booksInProgress",JSON.stringify(Array.from(n))),e.setState({allBooks:a,booksInProgressIds:n})},e.finishBook=function(t){var a=e.state.booksInProgressIds;a.delete(t),localStorage.setItem("booksInProgress",JSON.stringify(Array.from(a)));var o=e.state.booksDoneIds;o.add(t),localStorage.setItem("booksDone",JSON.stringify(Array.from(o))),e.setState({booksInProgressIds:a,booksDoneIds:o})},e.resetBook=function(t){var a=e.state.booksDoneIds;a.delete(t),localStorage.setItem("booksDone",JSON.stringify(Array.from(a)));var o=e.state.allBooks;o[t].moved=!1;var n=o.filter((function(e){return e.moved})).map((function(e){return e.id}));localStorage.setItem("movedBooks",JSON.stringify(n)),e.setState({booksDoneIds:a,allBooks:o})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("./data/30000-items.json").then((function(e){return e.json()})).then((function(t){t.items.forEach((function(e,t){return e.index=t}));var a=t.items;localStorage.getItem("movedBooks")||localStorage.setItem("movedBooks","[]");var o,n=JSON.parse(localStorage.getItem("movedBooks")),r=Object(i.a)(n);try{var s=function(){var e=o.value,t=a.find((function(t){return t.id===e}));t&&(t.moved=!0)};for(r.s();!(o=r.n()).done;)s()}catch(c){r.e(c)}finally{r.f()}e.setState({allBooks:a})}));var t=new URL(window.location.href);t.search="";var a=new URLSearchParams(window.location.search),o=a.get("tab");"toread"!==o&&"inprogress"!==o&&"done"!==o||(t.searchParams.set("tab",o),this.setState({currentTab:o}));var n=a.get("tags");n&&(t.searchParams.set("tags",n),this.setState({tags:new Set(n.split(","))})),window.history.pushState("","",t.toString()),localStorage.getItem("booksInProgress")||localStorage.setItem("booksInProgress","[]");var r=JSON.parse(localStorage.getItem("booksInProgress")).map((function(e){return+e}));this.setState({booksInProgressIds:new Set(r)}),localStorage.getItem("booksDone")||localStorage.setItem("booksDone","[]");var s=JSON.parse(localStorage.getItem("booksDone")).map((function(e){return+e}));this.setState({booksDoneIds:new Set(s)})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,a=e.allBooks,o=e.booksInProgressIds,r=e.booksDoneIds,s=e.tags,i=a.filter((function(e){return!e.moved})).length,c=o.size,l=r.size,u=this.startBook;return"inprogress"===t&&(u=this.finishBook),"done"===t&&(u=this.resetBook),n.a.createElement("div",{className:"app"},n.a.createElement(d,{currentTab:t,changeTab:this.changeTab,toRead:i,inProgress:c,done:l}),n.a.createElement(g,{tags:s,removeTag:this.removeTag,clearTags:this.clearTags}),n.a.createElement(f,{tab:t,books:a,tags:s,addTag:this.addTag,moveBook:u,booksInProgressIds:o,booksDoneIds:r}))}}]),a}(n.a.Component);s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(v,null)),document.getElementById("root"))},8:function(e,t,a){e.exports=a(15)}},[[8,1,2]]]);
//# sourceMappingURL=main.94b289f4.chunk.js.map